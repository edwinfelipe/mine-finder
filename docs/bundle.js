(()=>{var e={737:e=>{e.exports=(e,i)=>e.row===i.row-1&&e.col===i.col-1||e.row===i.row&&e.col===i.col-1||e.row===i.row+1&&e.col===i.col-1||e.row===i.row-1&&e.col===i.col||e.row===i.row+1&&e.col===i.col||e.row===i.row-1&&e.col===i.col+1||e.row===i.row&&e.col===i.col+1||e.row===i.row+1&&e.col===i.col+1||e.row+1===i.row&&e.col+1===i.col||void 0},167:e=>{e.exports=(e,i)=>Math.floor(Math.random()*(e-i+1)+i)}},i={};function o(l){var t=i[l];if(void 0!==t)return t.exports;var s=i[l]={exports:{}};return e[l](s,s.exports,o),s.exports}(()=>{const e=o(167),i=o(737);let l,t,s,r,c={};const a=["#aaffaa","#ccffaa","#ffffaa","#ffccaa"];class n{constructor({rows:e,cols:i,mines:o}){this.rows=e,this.cols=i,this.matrix=[],this.mines=o||10,this.firstFlip=!0}generateBoard(){const o=[];this.matrix=[];for(let i=0;i<this.mines;i++){let l,t;do{l=e(this.rows-1,0),t=e(this.cols-1,0),o[i]={row:l,col:t}}while(o.filter((e=>e.row===l&&e.col===t)).length>1)}for(let e=0;e<this.rows;e++)for(let i=0;i<this.cols;i++){const l=new f({row:e,col:i,hasMine:!1});o.find((e=>e.row===l.row&&e.col===l.col))&&(l.hasMine=!0),this.matrix.push(l)}for(let e of o)this.matrix.filter((o=>i(o,e))).map((e=>e.nearMines+=1))}draw(e){e.strokeStyle="#FFFFFF";for(let{row:i,col:o,hasMine:l,isFaceUp:t,isMarked:s,nearMines:r}of this.matrix)e.beginPath(),e.fillStyle=t?r>0&&!l?a[r-1]:"#DDDDDD":"#BBBBBB",e.fillRect(o*blockSize,i*blockSize,blockSize,blockSize),e.strokeRect(o*blockSize,i*blockSize,blockSize,blockSize),e.fill(),e.stroke(),e.closePath(),t?l?(e.beginPath(),e.fillStyle="#000000",e.arc(o*blockSize+blockSize/2,i*blockSize+blockSize/2,8,0,2*Math.PI),e.fill(),e.closePath()):(e.beginPath(),e.fillStyle="#000000",e.font="bold 36px courier",e.textAlign="center",e.textBaseline="middle",e.fillText(r||"",o*blockSize+blockSize/2,i*blockSize+blockSize/2),e.fill(),e.closePath()):s&&(e.beginPath(),e.fillStyle="#000000",e.font="bold 36px courier",e.textAlign="center",e.textBaseline="middle",e.fillText("X",o*blockSize+blockSize/2,i*blockSize+blockSize/2),e.fill(),e.closePath())}getNears(e){return this.matrix.filter((i=>{let o=Math.abs(i.row-e.row),l=Math.abs(i.col-e.col);return!i.isFaceUp&&o<2&&l<2}))}flipCell({row:e,col:i}){let o=this.matrix.filter((e=>!e.isFaceUp)),l=this.matrix.find((o=>o.row===e&&o.col===i));if(l.hasMine&&!this.firstFlip)return l.isFaceUp=!0,alert("You Made KBOOM!!!!"),this.generateBoard(),void(this.firstFlip=!0);if(o.length===this.mines+1&&!l.hasMine)return alert("You Win!!!!!"),this.generateBoard(),void(this.firstFlip=!0);let t=this.getNears(l);if(0!==l.nearMines||l.hasMine)if(this.firstFlip){this.firstFlip=!1;do{this.generateBoard()}while(this.matrix.find((o=>e===o.row&&i===o.col&&(0!==o.nearMines||o.hasMine))));let o=this.matrix.find((o=>o.row===e&&o.col===i));this.flipCell(o)}else l.isFaceUp=!0;else{this.firstFlip=!1,l.isFaceUp=!0,t.map((e=>e.isFaceUp=!0));for(let e of t)0===e.nearMines&&this.flipCell(e)}}markCell({row:e,col:i}){let o=this.matrix.find((o=>o.row===e&&o.col===i));o.isFaceUp||(o.isMarked=!o.isMarked)}}class f{constructor({row:e,col:i,hasMine:o}){this.row=e,this.col=i,this.hasMine=o,this.isMarked=!1,this.isFaceUp=!1,this.nearMines=0}}s=document.getElementById("cv"),r=s.getContext("2d"),l=new class{constructor(e){this.options=e}draw(e){for(let i=0;i<this.options.length;i++){let o=this.options[i];e.beginPath(),e.fillStyle="#DDDDDD",e.fillRect(0,100*i,s.width,90),e.fill(),e.closePath(),e.beginPath(),e.font="bold 24px courier",e.fillStyle="black",e.fillText(o.name,24,100*i+40),e.fill(),e.closePath(),e.beginPath(),e.font="bold 16px courier",e.fillStyle="black",e.fillText(`${o.cols} X ${o.rows}`,24,100*i+64),e.fill(),e.closePath(),e.beginPath(),e.font="bold 14px courier",e.fillStyle="#666666",e.fillText(`${o.mines} Mines`,24,100*i+80),e.fill(),e.closePath()}}}([{name:"Easy",rows:8,cols:8,mines:10},{name:"Medium",rows:16,cols:16,mines:40},{name:"Hard",rows:16,cols:28,mines:99}]),function e(){window.requestAnimationFrame(e),t?t.draw(r):l&&l.draw(r)}(),s.addEventListener("click",(({clientX:e,clientY:i})=>{if(t){let o=Math.floor((i-s.offsetTop)/blockSize),l=Math.floor((e-s.offsetLeft)/blockSize);t.flipCell({row:o,col:l})}else{let e=Math.floor((i-s.offsetTop)/100);c=l.options[e],blockSize=s.width/c.cols,s.width=blockSize*c.cols,s.height=blockSize*c.rows,t=new n({rows:c.rows,cols:c.cols,mines:c.mines}),t.generateBoard()}})),s.addEventListener("contextmenu",(e=>{if(e.preventDefault(),t){let i=Math.floor((e.clientY-s.offsetTop)/blockSize),o=Math.floor((e.clientX-s.offsetLeft)/blockSize);t.markCell({row:i,col:o})}}))})()})();