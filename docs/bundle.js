(()=>{var o={737:o=>{o.exports=(o,e)=>o.row===e.row-1&&o.col===e.col-1||o.row===e.row&&o.col===e.col-1||o.row===e.row+1&&o.col===e.col-1||o.row===e.row-1&&o.col===e.col||o.row===e.row+1&&o.col===e.col||o.row===e.row-1&&o.col===e.col+1||o.row===e.row&&o.col===e.col+1||o.row===e.row+1&&o.col===e.col+1||o.row+1===e.row&&o.col+1===e.col||void 0},167:o=>{o.exports=(o,e)=>Math.floor(Math.random()*(o-e+1)+e)}},e={};function t(l){var i=e[l];if(void 0!==i)return i.exports;var r=e[l]={exports:{}};return o[l](r,r.exports,t),r.exports}(()=>{const o=t(167),e=t(737);let l,i,r;const s=["#aaffaa","#ccffaa","#ffffaa","#ffccaa"];let c;class a{constructor({row:o,col:e,hasMine:t}){this.row=o,this.col=e,this.hasMine=t,this.isMarked=!1,this.isFaceUp=!1,this.nearMines=0}}i=document.getElementById("cv"),r=i.getContext("2d"),c=i.width/8,l=new class{constructor({rows:o,cols:e,mines:t}){this.rows=o,this.cols=e,this.matrix=[],this.mines=t||10,this.firstFlip=!0}generateBoard(){const t=[];this.matrix=[];for(let e=0;e<this.mines;e++){let l,i;do{l=o(this.rows-1,0),i=o(this.cols-1,0),t[e]={row:l,col:i}}while(t.filter((o=>o.row===l&&o.col===i)).length>1)}for(let o=0;o<this.rows;o++)for(let e=0;e<this.cols;e++){const l=new a({row:o,col:e,hasMine:!1});t.find((o=>o.row===l.row&&o.col===l.col))&&(l.hasMine=!0),this.matrix.push(l)}for(let o of t)this.matrix.filter((t=>e(t,o))).map((o=>o.nearMines+=1))}draw(o){o.strokeStyle="#FFFFFF";for(let{row:e,col:t,hasMine:l,isFaceUp:i,isMarked:r,nearMines:a}of this.matrix)o.beginPath(),o.fillStyle=i?a>0&&!l?s[a-1]:"#DDDDDD":"#BBBBBB",o.fillRect(t*c,e*c,c,c),o.strokeRect(t*c,e*c,c,c),o.fill(),o.stroke(),o.closePath(),i?l?(o.beginPath(),o.fillStyle="#000000",o.arc(t*c+c/2,e*c+c/2,8,0,2*Math.PI),o.fill(),o.closePath()):(o.beginPath(),o.fillStyle="#000000",o.font="bold 36px courier",o.textAlign="center",o.textBaseline="middle",o.fillText(a||"",t*c+c/2,e*c+c/2),o.fill(),o.closePath()):r&&(o.beginPath(),o.fillStyle="#000000",o.font="bold 36px courier",o.textAlign="center",o.textBaseline="middle",o.fillText("X",t*c+c/2,e*c+c/2),o.fill(),o.closePath())}getNears(o){return this.matrix.filter((e=>e.row===o.row-1&&e.col===o.col&&!e.isFaceUp||e.row===o.row+1&&e.col===o.col&&!e.isFaceUp||e.row===o.row&&e.col===o.col-1&&!e.isFaceUp||e.row===o.row&&e.col===o.col+1&&!e.isFaceUp))}flipCell({row:o,col:e}){let t=this.matrix.find((t=>t.row===o&&t.col===e)),l=this.getNears(t);if(0!==t.nearMines||t.hasMine)if(this.firstFlip){this.firstFlip=!1;do{this.generateBoard()}while(this.matrix.find((t=>o===t.row&&e===t.col&&(0!==t.nearMines||t.hasMine))));let t=this.matrix.find((t=>t.row===o&&t.col===e));this.flipCell(t)}else t.isFaceUp=!0;else{this.firstFlip=!1,t.isFaceUp=!0,l.map((o=>o.isFaceUp=!0));for(let o of l)0===o.nearMines&&this.flipCell(o)}}markCell({row:o,col:e}){let t=this.matrix.find((t=>t.row===o&&t.col===e));t.isFaceUp||(t.isMarked=!t.isMarked)}}({rows:8,cols:8,mines:10}),l.generateBoard(),function o(){window.requestAnimationFrame(o),l.draw(r)}(),i.addEventListener("click",(({clientX:o,clientY:e})=>{let t=Math.floor((e-i.offsetTop)/c),r=Math.floor((o-i.offsetLeft)/c);l.flipCell({row:t,col:r})})),i.addEventListener("contextmenu",(o=>{o.preventDefault();let e=Math.floor((o.clientY-i.offsetTop)/c),t=Math.floor((o.clientX-i.offsetLeft)/c);l.markCell({row:e,col:t})}))})()})();